defaults:
  - flow: default
  - training: default
  - hydra: default
  - _self_

target:
  num_grid_per_dim: 40  # [32 or 40]

flow:
  n_layers: 6
  transform_type: spline # spline or realnvp
  conditioner_mlp_units: [128, 128]  # rnvp was working well with [256, 256]
  spline_num_bins: 4


fab:
  alpha: 2.  # alpha-divergence param
  use_kl_loss: false # additional KL loss.
  w_adjust_clip: 10.
  smc:
    use_resampling: false
    n_intermediate_distributions: 10
    spacing_type: linear
    transition_operator: hmc # [hmc or metropolis]
    hmc:
      n_outer_steps: 1
      n_inner_steps: 5
      init_step_size: 1e-2
      target_p_accept: 0.65
      tune_step_size: true
    metropolis:
      n_outer_steps: 1
      init_step_size: 1.  # Needs to be big enough to jump between modes
      target_p_accept: 0.65
      tune_step_size: false
  buffer:
    with_buffer: True
    buffer_max_length_in_batches: 400
    buffer_min_length_in_batches: 40
    n_updates_per_smc_forward_pass: 4


training:
  n_epoch: 1e4
  batch_size: 1024
  eval_batch_size: 2_000
  plot_batch_size: 1_000
  seed: 0
  n_checkpoints: 0
  n_eval: 20


logger:
#  list_logger: null
#  pandas_logger:
#    save_period: 1000 # how often to save the pandas dataframe as a csv
  wandb:
    name: cox_${target.num_grid_per_dim}_lr_sched_EvenFatter_DecayLRTo0
    project: fab
    entity: flow-ais-bootstrap
    tags: [cox,fab,fabjax]