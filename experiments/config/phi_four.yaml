defaults:
  - fab: default
  - flow: default
  - training: default
  - hydra: default
  - _self_

flow:
  type: conv_coupling
#  n_layers: 4
#  transform_type: real_nvp # spline or real_nvp
#  act_norm: false
#  conditioner_mlp_units: [ 128, 128 ]


fab:
  smc:
    n_intermediate_distributions: 3
    spacing_type: linear
    transition_operator: hmc # [hmc or metropolis]
    hmc:
      n_outer_steps: 1
      n_inner_steps: 5
      init_step_size: 1e-3
      target_p_accept: 0.65
      tune_step_size: true
    metropolis:
      n_outer_steps: 1
      init_step_size: 5.
      target_p_accept: 0.65
      tune_step_size: true # If false, then init_step_size needs to be reasonably good.
    point_is_valid_fn:
      type: default # [default, in_bounds] - use in_bounds if we want to restrict SMC to the below bounds.


training:
  n_epoch: 4000
  eval_batch_size: 20_000 # For reverse ESS calculation
  n_samples_log_Z: 2_000 # eval_batch_size will be split into multiple batches of size n_samples_log_Z.
